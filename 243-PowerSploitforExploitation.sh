#!/bin/bash

CYAN='\033[1;36m'
RESET='\033[0m'

# Menu for the Three of Spades Card
three_of_spades_menu() {
    clear
    echo -e "${CYAN}"
    echo "      _________________________________________________________________________"
    echo "     |                              Three of Spades                            |"
    echo "     |                   Use PowerShell for Exploitation (PowerSploit)         |"
    echo "     |_________________________________________________________________________|"
    echo "     |                                                                         |"
    echo "     |  This card provides an interface to leverage the PowerSploit toolkit    |"
    echo "     |  for PowerShell-based exploitation and post-exploitation activities.    |"
    echo "     |                                                                         |"
    echo "     |                                                                         |"
    echo "     |  1. Clone PowerSploit repository                                        |"
    echo "     |  2. Execute a specific PowerSploit module                               |"
    echo "     |  3. View PowerSploit documentation                                      |"
    echo "     |  4. Exit                                                                |"
    echo "     |_________________________________________________________________________|"
    echo -e "${RESET}"
    read -p "Enter your choice: " choice
    case $choice in
        1) clone_powersploit ;;
        2) execute_module ;;
        3) view_powersploit_docs ;;
        4) exit 0 ;;
        *) echo "Invalid choice. Try again."; sleep 1; three_of_spades_menu ;;
    esac
}

# Clone PowerSploit repository
clone_powersploit() {
    clear
    echo -e "${CYAN}Cloning PowerSploit repository...${RESET}"
    if command -v git &>/dev/null; then
        git clone https://github.com/PowerShellMafia/PowerSploit.git
        echo "PowerSploit cloned to the current directory."
    else
        echo -e "${CYAN}Error: Git is not installed.${RESET}"
        echo "Please install Git to clone the PowerSploit repository."
    fi
    read -n 1 -s -r -p "Press any key to return to the menu..."
    three_of_spades_menu
}

# Execute a specific PowerSploit module
execute_module() {
    clear
    echo -e "${CYAN}Executing a PowerSploit module...${RESET}"
    read -p "Enter the PowerShell command to execute (e.g., Invoke-Mimikatz): " ps_command
    echo "Running PowerShell command: $ps_command"
    if command -v pwsh &>/dev/null; then
        pwsh -Command "$ps_command"
    else
        echo -e "${CYAN}Error: PowerShell is not installed.${RESET}"
        echo "Please install PowerShell to execute PowerSploit modules."
    fi
    read -n 1 -s -r -p "Press any key to return to the menu..."
    three_of_spades_menu
}

# View PowerSploit documentation
view_powersploit_docs() {
    clear
    echo -e "${CYAN}Viewing PowerSploit documentation...${RESET}"
    if command -v xdg-open &>/dev/null; then
        xdg-open "https://github.com/PowerShellMafia/PowerSploit/wiki"
    else
        echo -e "${CYAN}Please visit: https://github.com/PowerShellMafia/PowerSploit/wiki${RESET}"
    fi
    read -n 1 -s -r -p "Press any key to return to the menu..."
    three_of_spades_menu
}

three_of_spades_menu
