#!/bin/bash

CYAN='\033[1;36m'
RESET='\033[0m'

pentest_tools() {
    while true; do
        clear
        echo -e "${CYAN}"
        echo "     ___________________________________________"
        echo "    |               Five of Spades              |"
        echo "    |   Execute Controlled Penetration Tests    |"
        echo "    |___________________________________________|"
        echo "    |                                           |"
        echo "    |  1. Scan for open ports                   |"
        echo "    |  2. Test web application vulnerabilities  |"
        echo "    |  3. Perform brute-force login tests       |"
        echo "    |  4. Enumerate active directories          |"
        echo "    |  5. Exit                                  |"
        echo "    |___________________________________________|"
        echo -e "${RESET}"

        read -p "Choice: " choice
        case $choice in
            1)
                clear
                echo -e "${CYAN}Scanning for open ports using built-in tools...${RESET}"
                read -p "Enter the target IP or hostname: " target
                echo "Scanning $target for open ports..."
                for port in {1..1024}; do
                    timeout 1 bash -c "echo > /dev/tcp/$target/$port" 2>/dev/null && echo "Port $port is open."
                done || echo "No open ports detected in the range 1-1024."
                ;;
            2)
                clear
                echo -e "${CYAN}Testing web application vulnerabilities...${RESET}"
                read -p "Enter the URL to test: " url
                echo "Checking $url for vulnerabilities..."
                curl -s -I "$url" | grep -E "Server|X-Powered-By"
                echo "Testing for SQL injection with sample payloads..."
                curl -s "$url?id=1' OR '1'='1" | grep "error" && echo "Potential SQL Injection vulnerability detected."
                ;;
            3)
                clear
                echo -e "${CYAN}Performing brute-force login tests...${RESET}"
                read -p "Enter the target IP or hostname: " target
                read -p "Enter the username: " username
                echo "Trying common passwords for user $username on $target..."
                for password in admin password 123456 root letmein; do
                    echo "Testing password: $password"
                    sshpass -p "$password" ssh -o BatchMode=yes -o ConnectTimeout=5 $username@$target echo "Success" 2>/dev/null && echo "Password found: $password" && break
                done || echo "No valid password found in the list."
                ;;
            4)
                clear
                echo -e "${CYAN}Enumerating active directories...${RESET}"
                read -p "Enter the target IP or hostname: " target
                echo "Enumerating directories on $target..."
                curl -s "$target" | grep -oP '(?<=href=")[^"]*' || echo "No directories found."
                ;;
            5)
                echo -e "${CYAN}Exiting...${RESET}"
                break
                ;;
            *)
                echo -e "${CYAN}Invalid choice. Try again.${RESET}"
                ;;
        esac
        echo -e "${CYAN}Press any key to return to the menu...${RESET}"
        read -n 1 -s
    done
}

pentest_tools
