#!/bin/bash

CYAN='\033[1;36m'
RESET='\033[0m'

detect_malware_patterns() {
    while true; do
        clear
        echo -e "${CYAN}"
        echo "     ___________________________________________"
        echo "    |               Three of Hearts             |"
        echo "    |    Detect and Classify Malware Patterns   |"
        echo "    |___________________________________________|"
        echo "    |                                           |"
        echo "    |  1. Scan a directory for malware          |"
        echo "    |  2. Inspect YARA rule sets                |"
        echo "    |  3. Test YARA rules on a file             |"
        echo "    |  4. Exit                                  |"
        echo "    |___________________________________________|"
        echo -e "${RESET}"

        read -p "Choice: " choice
        case $choice in
            1)
                clear
                echo -e "${CYAN}Scanning a directory for malware patterns...${RESET}"
                read -p "Enter directory path: " dir_path
                if [ -d "$dir_path" ]; then
                    echo -e "${CYAN}Using YARA to scan $dir_path...${RESET}"
                    yara -r /path/to/rules.yar "$dir_path" || echo -e "${CYAN}No matches found or error occurred.${RESET}"
                else
                    echo -e "${CYAN}Invalid directory path.${RESET}"
                fi
                echo -e "${CYAN}Press any key to return to the menu...${RESET}"
                read -n 1 -s -r
                ;;
            2)
                clear
                echo -e "${CYAN}Inspecting available YARA rule sets...${RESET}"
                if [ -d /path/to/rules ]; then
                    ls /path/to/rules
                else
                    echo -e "${CYAN}No YARA rule sets found. Ensure rules are properly configured.${RESET}"
                fi
                echo -e "${CYAN}Press any key to return to the menu...${RESET}"
                read -n 1 -s -r
                ;;
            3)
                clear
                echo -e "${CYAN}Testing YARA rules on a specific file...${RESET}"
                read -p "Enter file path: " file_path
                if [ -f "$file_path" ]; then
                    echo -e "${CYAN}Using YARA to test $file_path...${RESET}"
                    yara /path/to/rules.yar "$file_path" || echo -e "${CYAN}No matches found or error occurred.${RESET}"
                else
                    echo -e "${CYAN}Invalid file path.${RESET}"
                fi
                echo -e "${CYAN}Press any key to return to the menu...${RESET}"
                read -n 1 -s -r
                ;;
            4)
                echo -e "${CYAN}Exiting...${RESET}"
                break
                ;;
            *)
                echo -e "${CYAN}Invalid choice. Try again.${RESET}"
                ;;
        esac
    done
}

detect_malware_patterns
