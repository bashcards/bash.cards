#!/bin/bash

CYAN='\033[1;36m'
RESET='\033[0m'

sandboxed_malware_analysis() {
    while true; do
        clear
        echo -e "${CYAN}"
        echo "     ___________________________________________"
        echo "    |               Four of Hearts              |"
        echo "    |      Perform Sandboxed Malware Analysis   |"
        echo "    |___________________________________________|"
        echo "    |                                           |"
        echo "    |  1. Submit a file for analysis            |"
        echo "    |  2. View recent analysis results          |"
        echo "    |  3. Monitor sandbox activity logs         |"
        echo "    |  4. Exit                                  |"
        echo "    |___________________________________________|"
        echo -e "${RESET}"

        read -p "Choice: " choice
        case $choice in
            1)
                clear
                echo -e "${CYAN}Submitting a file for sandboxed malware analysis...${RESET}"
                read -p "Enter file path to analyze: " file_path
                if [ -f "$file_path" ]; then
                    echo -e "${CYAN}Submitting $file_path for analysis...${RESET}"
                    cp "$file_path" /tmp/cuckoo/drop/ && echo -e "${CYAN}File submitted successfully.${RESET}" || echo -e "${CYAN}Failed to submit the file.${RESET}"
                else
                    echo -e "${CYAN}Invalid file path.${RESET}"
                fi
                echo -e "${CYAN}Press any key to return to the menu...${RESET}"
                read -n 1 -s -r
                ;;
            2)
                clear
                echo -e "${CYAN}Viewing recent analysis results...${RESET}"
                if [ -d /tmp/cuckoo/results ]; then
                    ls /tmp/cuckoo/results
                else
                    echo -e "${CYAN}No recent results found. Run an analysis first.${RESET}"
                fi
                echo -e "${CYAN}Press any key to return to the menu...${RESET}"
                read -n 1 -s -r
                ;;
            3)
                clear
                echo -e "${CYAN}Monitoring sandbox activity logs...${RESET}"
                if [ -f /tmp/cuckoo/logs/cuckoo.log ]; then
                    tail -f /tmp/cuckoo/logs/cuckoo.log
                else
                    echo -e "${CYAN}No activity logs found. Ensure the sandbox is running.${RESET}"
                fi
                echo -e "${CYAN}Press any key to return to the menu...${RESET}"
                read -n 1 -s -r
                ;;
            4)
                echo -e "${CYAN}Exiting...${RESET}"
                break
                ;;
            *)
                echo -e "${CYAN}Invalid choice. Try again.${RESET}"
                ;;
        esac
    done
}

sandboxed_malware_analysis
